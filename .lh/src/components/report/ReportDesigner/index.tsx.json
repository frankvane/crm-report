{
    "sourceFile": "src/components/report/ReportDesigner/index.tsx",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 5,
            "patches": [
                {
                    "date": 1747022323133,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1747022402573,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,25 +1,25 @@\n-import { Layout } from 'antd';\r\n-import React from 'react';\r\n+import { Layout } from \"antd\";\r\n+import React from \"react\";\r\n \r\n const { Sider, Content } = Layout;\r\n \r\n const ReportDesigner: React.FC = () => {\r\n   return (\r\n-    <Layout style={{ height: '100vh' }}>\r\n-      <Sider width={200} style={{ background: '#fff' }}>\r\n+    <Layout style={{ height: \"100vh\" }}>\r\n+      <Sider width={200} style={{ background: \"#fff\" }}>\r\n         {/* 工具栏/组件库 */}\r\n         组件库\r\n       </Sider>\r\n       <Content style={{ padding: 24, minHeight: 280 }}>\r\n         {/* 设计画布 */}\r\n         设计画布\r\n       </Content>\r\n-      <Sider width={300} style={{ background: '#fafafa' }}>\r\n+      <Sider width={300} style={{ background: \"#fafafa\" }}>\r\n         {/* 属性面板 */}\r\n         属性面板\r\n       </Sider>\r\n\\ No newline at end of file\n     </Layout>\r\n   );\r\n };\r\n \r\n-export default ReportDesigner;\n+export default ReportDesigner;\r\n"
                },
                {
                    "date": 1747022408729,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -21,5 +21,5 @@\n     </Layout>\r\n   );\r\n };\r\n \r\n-export default ReportDesigner;\n\\ No newline at end of file\n+export default ReportDesigner;\r\n"
                },
                {
                    "date": 1747022747354,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,24 +1,72 @@\n-import { Layout } from \"antd\";\r\n+import { Divider, Layout, Typography } from \"antd\";\r\n+\r\n import React from \"react\";\r\n+import Toolbar from \"./Toolbar\";\r\n \r\n-const { Sider, Content } = Layout;\r\n+const { Sider, Content, Header } = Layout;\r\n+const { Title } = Typography;\r\n \r\n+const componentList = [\r\n+  { type: \"table\", name: \"表格\", icon: \"📋\" },\r\n+  { type: \"chart\", name: \"图表\", icon: \"📊\" },\r\n+  { type: \"text\", name: \"文本\", icon: \"🔤\" },\r\n+];\r\n+\r\n const ReportDesigner: React.FC = () => {\r\n   return (\r\n     <Layout style={{ height: \"100vh\" }}>\r\n-      <Sider width={200} style={{ background: \"#fff\" }}>\r\n-        {/* 工具栏/组件库 */}\r\n-        组件库\r\n-      </Sider>\r\n-      <Content style={{ padding: 24, minHeight: 280 }}>\r\n-        {/* 设计画布 */}\r\n-        设计画布\r\n-      </Content>\r\n-      <Sider width={300} style={{ background: \"#fafafa\" }}>\r\n-        {/* 属性面板 */}\r\n-        属性面板\r\n-      </Sider>\r\n+      <Header style={{ background: \"#fff\", padding: \"0 24px\", boxShadow: \"0 2px 8px #f0f1f2\" }}>\r\n+        <div style={{ display: \"flex\", alignItems: \"center\", height: \"100%\" }}>\r\n+          <Title level={4} style={{ margin: 0, flex: 1 }}>报表设计器</Title>\r\n+          <Toolbar />\r\n+        </div>\r\n+      </Header>\r\n+      <Layout>\r\n+        <Sider width={200} style={{ background: \"#fff\", borderRight: \"1px solid #f0f0f0\", padding: 16 }}>\r\n+          <Title level={5} style={{ marginTop: 0 }}>组件库</Title>\r\n+          <Divider style={{ margin: \"8px 0\" }} />\r\n+          <div style={{ display: \"flex\", flexDirection: \"column\", gap: 12 }}>\r\n+            {componentList.map((item) => (\r\n+              <div key={item.type} style={{\r\n+                display: \"flex\",\r\n+                alignItems: \"center\",\r\n+                padding: \"8px 12px\",\r\n+                border: \"1px solid #e5e5e5\",\r\n+                borderRadius: 6,\r\n+                background: \"#fafafa\",\r\n+                cursor: \"pointer\",\r\n+                fontSize: 16,\r\n+                transition: \"box-shadow 0.2s\",\r\n+              }}>\r\n+                <span style={{ marginRight: 8 }}>{item.icon}</span>\r\n+                {item.name}\r\n+              </div>\r\n+            ))}\r\n+          </div>\r\n+        </Sider>\r\n+        <Content style={{ padding: 24, minHeight: 280, background: \"#f5f6fa\" }}>\r\n+          {/* 设计画布 */}\r\n+          <div style={{\r\n+            minHeight: 500,\r\n+            border: \"2px dashed #bfbfbf\",\r\n+            borderRadius: 8,\r\n+            background: \"#fff\",\r\n+            display: \"flex\",\r\n+            alignItems: \"center\",\r\n+            justifyContent: \"center\",\r\n+            color: \"#bfbfbf\",\r\n+            fontSize: 20,\r\n+          }}>\r\n+            设计画布区域（可拖拽组件到此处）\r\n+          </div>\r\n+        </Content>\r\n+        <Sider width={300} style={{ background: \"#fafafa\", borderLeft: \"1px solid #f0f0f0\", padding: 16 }}>\r\n+          <Title level={5} style={{ marginTop: 0 }}>属性面板</Title>\r\n+          <Divider style={{ margin: \"8px 0\" }} />\r\n+          <div style={{ color: \"#aaa\" }}>请选择画布中的组件进行属性编辑</div>\r\n+        </Sider>\r\n+      </Layout>\r\n     </Layout>\r\n   );\r\n };\r\n \r\n"
                },
                {
                    "date": 1747022837821,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -1,8 +1,15 @@\n import { Divider, Layout, Typography } from \"antd\";\r\n+import {\r\n+  DndContext,\r\n+  DragEndEvent,\r\n+  useDraggable,\r\n+  useDroppable,\r\n+} from \"@dnd-kit/core\";\r\n+import React, { useState } from \"react\";\r\n \r\n-import React from \"react\";\r\n import Toolbar from \"./Toolbar\";\r\n+import { generateId } from \"../../../utils/reportUtils\";\r\n \r\n const { Sider, Content, Header } = Layout;\r\n const { Title } = Typography;\r\n \r\n@@ -11,89 +18,139 @@\n   { type: \"chart\", name: \"图表\", icon: \"📊\" },\r\n   { type: \"text\", name: \"文本\", icon: \"🔤\" },\r\n ];\r\n \r\n+// 可拖拽组件\r\n+const DraggableComponent: React.FC<{ type: string; name: string; icon: string }> = ({ type, name, icon }) => {\r\n+  const { attributes, listeners, setNodeRef, isDragging } = useDraggable({ id: `lib-${type}` });\r\n+  return (\r\n+    <div\r\n+      ref={setNodeRef}\r\n+      {...listeners}\r\n+      {...attributes}\r\n+      style={{\r\n+        display: \"flex\",\r\n+        alignItems: \"center\",\r\n+        padding: \"8px 12px\",\r\n+        border: \"1px solid #e5e5e5\",\r\n+        borderRadius: 6,\r\n+        background: isDragging ? \"#e6f7ff\" : \"#fafafa\",\r\n+        cursor: \"grab\",\r\n+        fontSize: 16,\r\n+        opacity: isDragging ? 0.5 : 1,\r\n+        transition: \"box-shadow 0.2s\",\r\n+      }}\r\n+    >\r\n+      <span style={{ marginRight: 8 }}>{icon}</span>\r\n+      {name}\r\n+    </div>\r\n+  );\r\n+};\r\n+\r\n+// 画布区域可放置\r\n+const CanvasDroppable: React.FC<{\r\n+  children: React.ReactNode;\r\n+  onDrop: (type: string) => void;\r\n+}> = ({ children, onDrop }) => {\r\n+  const { setNodeRef, isOver } = useDroppable({ id: \"canvas\" });\r\n+  return (\r\n+    <div\r\n+      ref={setNodeRef}\r\n+      style={{\r\n+        minHeight: 500,\r\n+        border: isOver ? \"2px solid #1890ff\" : \"2px dashed #bfbfbf\",\r\n+        borderRadius: 8,\r\n+        background: \"#fff\",\r\n+        display: \"flex\",\r\n+        alignItems: \"center\",\r\n+        justifyContent: \"center\",\r\n+        color: \"#bfbfbf\",\r\n+        fontSize: 20,\r\n+        position: \"relative\",\r\n+        transition: \"border 0.2s\",\r\n+      }}\r\n+    >\r\n+      {children}\r\n+    </div>\r\n+  );\r\n+};\r\n+\r\n const ReportDesigner: React.FC = () => {\r\n+  // 画布上的组件\r\n+  const [canvasComponents, setCanvasComponents] = useState<{\r\n+    id: string;\r\n+    type: string;\r\n+    name: string;\r\n+    icon: string;\r\n+  }[]>([]);\r\n+\r\n+  // 拖拽结束处理\r\n+  const handleDragEnd = (event: DragEndEvent) => {\r\n+    const { over, active } = event;\r\n+    if (over && over.id === \"canvas\" && active.id.toString().startsWith(\"lib-\")) {\r\n+      const type = active.id.toString().replace(\"lib-\", \"\");\r\n+      const comp = componentList.find((c) => c.type === type);\r\n+      if (comp) {\r\n+        setCanvasComponents((prev) => [\r\n+          ...prev,\r\n+          { ...comp, id: generateId() },\r\n+        ]);\r\n+      }\r\n+    }\r\n+  };\r\n+\r\n   return (\r\n     <Layout style={{ height: \"100vh\" }}>\r\n-      <Header\r\n-        style={{\r\n-          background: \"#fff\",\r\n-          padding: \"0 24px\",\r\n-          boxShadow: \"0 2px 8px #f0f1f2\",\r\n-        }}\r\n-      >\r\n+      <Header style={{ background: \"#fff\", padding: \"0 24px\", boxShadow: \"0 2px 8px #f0f1f2\" }}>\r\n         <div style={{ display: \"flex\", alignItems: \"center\", height: \"100%\" }}>\r\n-          <Title level={4} style={{ margin: 0, flex: 1 }}>\r\n-            报表设计器\r\n-          </Title>\r\n+          <Title level={4} style={{ margin: 0, flex: 1 }}>报表设计器</Title>\r\n           <Toolbar />\r\n         </div>\r\n       </Header>\r\n       <Layout>\r\n-        <Sider\r\n-          width={200}\r\n-          style={{\r\n-            background: \"#fff\",\r\n-            borderRight: \"1px solid #f0f0f0\",\r\n-            padding: 16,\r\n-          }}\r\n-        >\r\n-          <Title level={5} style={{ marginTop: 0 }}>\r\n-            组件库\r\n-          </Title>\r\n+        <Sider width={200} style={{ background: \"#fff\", borderRight: \"1px solid #f0f0f0\", padding: 16 }}>\r\n+          <Title level={5} style={{ marginTop: 0 }}>组件库</Title>\r\n           <Divider style={{ margin: \"8px 0\" }} />\r\n           <div style={{ display: \"flex\", flexDirection: \"column\", gap: 12 }}>\r\n             {componentList.map((item) => (\r\n-              <div\r\n-                key={item.type}\r\n-                style={{\r\n-                  display: \"flex\",\r\n-                  alignItems: \"center\",\r\n-                  padding: \"8px 12px\",\r\n-                  border: \"1px solid #e5e5e5\",\r\n-                  borderRadius: 6,\r\n-                  background: \"#fafafa\",\r\n-                  cursor: \"pointer\",\r\n-                  fontSize: 16,\r\n-                  transition: \"box-shadow 0.2s\",\r\n-                }}\r\n-              >\r\n-                <span style={{ marginRight: 8 }}>{item.icon}</span>\r\n-                {item.name}\r\n-              </div>\r\n+              <DraggableComponent key={item.type} {...item} />\r\n             ))}\r\n           </div>\r\n         </Sider>\r\n         <Content style={{ padding: 24, minHeight: 280, background: \"#f5f6fa\" }}>\r\n-          {/* 设计画布 */}\r\n-          <div\r\n-            style={{\r\n-              minHeight: 500,\r\n-              border: \"2px dashed #bfbfbf\",\r\n-              borderRadius: 8,\r\n-              background: \"#fff\",\r\n-              display: \"flex\",\r\n-              alignItems: \"center\",\r\n-              justifyContent: \"center\",\r\n-              color: \"#bfbfbf\",\r\n-              fontSize: 20,\r\n-            }}\r\n-          >\r\n-            设计画布区域（可拖拽组件到此处）\r\n-          </div>\r\n+          <DndContext onDragEnd={handleDragEnd}>\r\n+            <CanvasDroppable onDrop={() => {}}>\r\n+              {canvasComponents.length === 0 ? (\r\n+                <span>设计画布区域（可拖拽组件到此处）</span>\r\n+              ) : (\r\n+                <div style={{ width: \"100%\" }}>\r\n+                  {canvasComponents.map((comp) => (\r\n+                    <div\r\n+                      key={comp.id}\r\n+                      style={{\r\n+                        display: \"flex\",\r\n+                        alignItems: \"center\",\r\n+                        gap: 8,\r\n+                        border: \"1px solid #e5e5e5\",\r\n+                        borderRadius: 6,\r\n+                        background: \"#fafafa\",\r\n+                        padding: \"12px 16px\",\r\n+                        marginBottom: 12,\r\n+                        fontSize: 16,\r\n+                        color: \"#333\",\r\n+                      }}\r\n+                    >\r\n+                      <span>{comp.icon}</span>\r\n+                      {comp.name}组件\r\n+                    </div>\r\n+                  ))}\r\n+                </div>\r\n+              )}\r\n+            </CanvasDroppable>\r\n+          </DndContext>\r\n         </Content>\r\n-        <Sider\r\n-          width={300}\r\n-          style={{\r\n-            background: \"#fafafa\",\r\n-            borderLeft: \"1px solid #f0f0f0\",\r\n-            padding: 16,\r\n-          }}\r\n-        >\r\n-          <Title level={5} style={{ marginTop: 0 }}>\r\n-            属性面板\r\n-          </Title>\r\n+        <Sider width={300} style={{ background: \"#fafafa\", borderLeft: \"1px solid #f0f0f0\", padding: 16 }}>\r\n+          <Title level={5} style={{ marginTop: 0 }}>属性面板</Title>\r\n           <Divider style={{ margin: \"8px 0\" }} />\r\n           <div style={{ color: \"#aaa\" }}>请选择画布中的组件进行属性编辑</div>\r\n         </Sider>\r\n       </Layout>\r\n"
                },
                {
                    "date": 1747022850812,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -54,10 +54,11 @@\n \r\n // 画布区域可放置\r\n const CanvasDroppable: React.FC<{\r\n   children: React.ReactNode;\r\n+  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n   onDrop: (type: string) => void;\r\n-}> = ({ children, onDrop }) => {\r\n+}> = ({ children }) => {\r\n   const { setNodeRef, isOver } = useDroppable({ id: \"canvas\" });\r\n   return (\r\n     <div\r\n       ref={setNodeRef}\r\n"
                }
            ],
            "date": 1747022323133,
            "name": "Commit-0",
            "content": "import { Layout } from 'antd';\r\nimport React from 'react';\r\n\r\nconst { Sider, Content } = Layout;\r\n\r\nconst ReportDesigner: React.FC = () => {\r\n  return (\r\n    <Layout style={{ height: '100vh' }}>\r\n      <Sider width={200} style={{ background: '#fff' }}>\r\n        {/* 工具栏/组件库 */}\r\n        组件库\r\n      </Sider>\r\n      <Content style={{ padding: 24, minHeight: 280 }}>\r\n        {/* 设计画布 */}\r\n        设计画布\r\n      </Content>\r\n      <Sider width={300} style={{ background: '#fafafa' }}>\r\n        {/* 属性面板 */}\r\n        属性面板\r\n      </Sider>\r\n    </Layout>\r\n  );\r\n};\r\n\r\nexport default ReportDesigner;"
        }
    ]
}